---
title: '3422.水叮当的舞步'
categories: 
  - JZOJ
  - JZ高中OJ
tags:
	- OJ
---

Time Limits: 1000 ms  Memory Limits: 262144 KB

## Description

水叮当得到了一块五颜六色的格子形地毯作为生日礼物，更加特别的是，地毯上格子的颜色还能随着踩踏而改变。

为了讨好她的偶像虹猫，水叮当决定在地毯上跳一支轻盈的舞来卖萌~~~

地毯上的格子有N行N列，每个格子用一个0~5之间的数字代表它的颜色。

水叮当可以随意选择一个0~5之间的颜色，然后轻轻地跳动一步，地毯左上角的格子所在的联通块里的所有格子就会变成她选择的那种颜色。这里连通定义为：两个格子有公共边，并且颜色相同。

由于水叮当是施展轻功来跳舞的，为了不消耗过多的真气，她想知道最少要多少步才能把所有格子的颜色变成一样的。



## Input

每个测试点包含多组数据。

每组数据的第一行是一个整数N，表示地摊上的格子有N行N列。

接下来一个N*N的矩阵，矩阵中的每个数都在0~5之间，描述了每个格子的颜色。

N=0代表输入的结束。

## Output

对于每组数据，输出一个整数，表示最少步数。

## Sample Input

```
2
0 0 
0 0
3
0 1 2
1 1 2
2 2 1
0
```

## Sample Output

```
0
3
```

## Data Constraint

对于30%的数据，N<=5

对于50%的数据，N<=6

对于70%的数据，N<=7

对于100%的数据，N<=8，每个测试点不多于20组数据。

## Code

```cpp
#include<iostream>
#include<stdio.h>
#include<string.h>
using namespace std;
int    xx[4]={0,0,-1,1};
int    yy[4]={1,-1,0,0};
int    a[10][10],vis[10][10],e[6];
int    n,flag,d;
void color(int x,int y,int col)
{
    vis[x][y]=1;
    for(int i=0;i<4;i++)
    {
        int nx=x+xx[i],ny=y+yy[i];
        if(nx<1||nx>n||ny<1||ny>n||vis[nx][ny]==1)
            continue;
        vis[nx][ny]=2;
        if(a[nx][ny]==col)
            color(nx,ny,col);
    }
}
int eva(int s)
{
    int cnt=0;
    memset(e,0,sizeof(e));
    for(int i=1;i<=n;i++)
        for(int j=1;j<=n;j++)
            if(vis[i][j]!=1&&!e[a[i][j]])
                e[a[i][j]]=1,cnt++;
    return(cnt);
}
bool judge(int col)
{
    int tmp=0;
    for(int i=1;i<=n;i++)
        for(int j=1;j<=n;j++)
            if(a[i][j]==col&&vis[i][j]==2)
            {
                tmp++;
                color(i,j,col);
            }
    return(tmp>0);
}
void search(int s)
{
    int tmp=eva(s),t[10][10];
    if(tmp==0)
    {
        flag=1;
        return;
    }else if(tmp+s>d)
        return;
    for(int i=0;i<=5;i++)
    {
        memcpy(t,vis,sizeof(t));
        if(judge(i))
            search(s+1);
        memcpy(vis,t,sizeof(vis));
        if(flag)
            return;
    }
}
int main()
{
    while(scanf("%d",&n)!=EOF&&n)
    {
        flag=0;memset(vis,0,sizeof(vis));
        for(int i=1;i<=n;i++)
            for(int j=1;j<=n;j++)
                cin>>a[i][j];
        color(1,1,a[1][1]);
        for(d=0;d>=0;d++)
        {
            search(0);
            if(flag)
            {
                cout<<d<<endl;
                break;
            }
        }
    }
    return 0;
}
```